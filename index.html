<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeLink ‚Äî –¢–≤–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å</title>

    <meta name="description" content="–ü—Ä–µ–≤—Ä–∞—Ç–∏ —Å–≤–æ–µ —Å–∫—É—á–Ω–æ–µ —Ä–µ–∑—é–º–µ –≤ —Å—Ç–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å –ø–æ–º–æ—â—å—é –ò–ò. Transform your boring resume into a stylish interactive profile with AI.">
    <meta name="keywords" content="—Ä–µ–∑—é–º–µ, —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑—é–º–µ, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ–∑—é–º–µ, resume builder, AI resume, ATS score, ResumeLink">
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "ResumeLink",
      "description": "AI tool to transform PDF resumes into interactive profiles",
      "applicationCategory": "BusinessApplication",
      "offers": { "@type": "Offer", "price": "0" }
    }
    </script>

    <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="manifest" href="/favicon/site.webmanifest">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="importmap">
        { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
    </script>

    <style>
        body { background: #0a0a0a; font-family: 'Outfit', sans-serif; color: white; min-height: 100vh; margin: 0; overflow-x: hidden; }
        .grid-layout { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; grid-auto-rows: min-content; }
        .card-item { background: #161616; border: 1px solid #262626; border-radius: 32px; padding: 1.8rem; transition: all 0.4s; position: relative; word-break: break-word; }
        .card-item:hover { transform: scale(1.02); border-color: #10b981; }
        .name-fix { font-weight: 900; line-height: 1.2 !important; display: block; padding: 0.15em 0; letter-spacing: -0.02em; }

        /* –û–ñ–ò–í–®–ê–Ø –†–ê–ú–ö–ê */
        .glow-wrapper {
            position: relative;
            display: inline-block;
            padding: 3px;
            border-radius: 28px;
            overflow: hidden;
            z-index: 10;
        }

        .glow-wrapper::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, #10b981, #3b82f6, transparent 60%);
            animation: rotate-glow 4s linear infinite;
            z-index: -1;
        }

        .glow-content {
            background: #0a0a0a;
            border-radius: 26px;
            display: block;
        }

        @keyframes rotate-glow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .spinner { border: 3px solid #222; border-top: 3px solid #10b981; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @media (max-width: 1024px) { .grid-layout { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 640px) { .grid-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";
        const { useState, useEffect } = React;
        const pdfjs = window['pdfjs-dist/build/pdf'];
        pdfjs.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const WORKER_URL = "https://resumelink-worker.aisrail.workers.dev";

        function App() {
            const [resumeData, setResumeData] = useState(null);
            const [loading, setLoading] = useState(false);
            const [loadingStage, setLoadingStage] = useState(0); 
            const [step, setStep] = useState('setup');
            const [savedId, setSavedId] = useState(null);
            
            const apiKey = 'AIzaSyAQ_Sr41LA4HGKkIakTin0okQnyblOl0Ts';

            const isEn = navigator.language.startsWith('en');
            const T = {
                en: {
                    mainTitle: "Transform your boring resume into a stylish interactive profile",
                    uploadBtn: "Upload Resume",
                    backBtn: "‚Üê Back",
                    atsScore: "ATS Score",
                    contact: "For cooperation:",
                    footerEng: "Empowering professionals with AI-driven visual storytelling.",
                    steps: [
                        { t: "UPLOAD", d: "Upload your file in any format." },
                        { t: "AI MAGIC", d: "AI structures data and calculates ATS." },
                        { t: "SHARE", d: "Get your link and personal QR code." }
                    ],
                    stages: ["Analyzing text...", "Extracting data...", "Generating blocks...", "Creating QR code...", "Optimizing mobile layout...", "Finalizing interactive elements...", "Almost ready..."]
                },
                ru: {
                    mainTitle: "–ü—Ä–µ–≤—Ä–∞—Ç–∏ —Å–∫—É—á–Ω–æ–µ —Ä–µ–∑—é–º–µ –≤ —Å—Ç–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å",
                    uploadBtn: "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—é–º–µ",
                    backBtn: "‚Üê –ù–∞–∑–∞–¥",
                    atsScore: "ATS Score",
                    contact: "–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞:",
                    footerEng: "Empowering professionals with AI-driven visual storytelling.",
                    steps: [
                        { t: "–ó–ê–ì–†–£–ó–ö–ê", d: "–ó–∞–≥—Ä—É–∑–∏ —Ñ–∞–π–ª –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ." },
                        { t: "AI –ú–ê–ì–ò–Ø", d: "–ù–µ–π—Ä–æ—Å–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å—á–∏—Ç–∞–µ—Ç ATS." },
                        { t: "–ü–û–î–ï–õ–ò–¢–¨–°–Ø", d: "–ü–æ–ª—É—á–∏ —Å—Å—ã–ª–∫—É –∏ –ª–∏—á–Ω—ã–π QR-–∫–æ–¥." }
                    ],
                    stages: ["–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç...", "–ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ...", "–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–ª–æ–∫–∏...", "–°–æ–∑–¥–∞—ë–º QR-–∫–æ–¥...", "–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å—Ç–∫—É...", "–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤...", "–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ..."]
                }
            };

            const curr = isEn ? T.en : T.ru;

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const id = params.get('id');
                if (id) {
                    setLoading(true);
                    fetch(`${WORKER_URL}/${id}`).then(res => res.json()).then(data => {
                        setResumeData(data);
                        setSavedId(id);
                        setStep('result');
                        setLoading(false);
                    }).catch(() => setLoading(false));
                }
            }, []);

            useEffect(() => {
                let interval;
                if (loading) {
                    interval = setInterval(() => {
                        setLoadingStage(prev => (prev < curr.stages.length - 1 ? prev + 1 : prev));
                    }, 2500);
                }
                return () => clearInterval(interval);
            }, [loading, curr.stages.length]);

            const autoPublish = async (data) => {
                try {
                    const res = await fetch(WORKER_URL, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data)
                    });
                    const result = await res.json();
                    setSavedId(result.id);
                    const newUrl = `${window.location.origin}${window.location.pathname}?id=${result.id}`;
                    window.history.pushState({ path: newUrl }, '', newUrl);
                } catch (err) { console.error(err); }
            };

            const processAI = async (text) => {
                try {
                    const genAI = new GoogleGenerativeAI(apiKey);
                    const model = genAI.getGenerativeModel({ model: "gemini-flash-latest" });
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –ª–æ–≥–∏–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–º–µ–Ω–∏ –∏ –¥–æ–ø. –±–ª–æ–∫–∞–º–∏
                    const prompt = `Analyze text and extract into JSON. Target language: ${isEn ? 'English' : 'Russian'}. 
                    Task: Create a professional interactive profile. 
                    MANDATORY FOR NAME: If target language is English, format the "name" field as "First Name Last Name" only (omit patronymic/middle name). If Russian, keep full name.
                    MANDATORY FOR BLOCKS: If the text contains enough information, generate additional blocks in "additional" array (e.g., "Key Achievements", "Professional Strengths", or "Tech Stack"). If no specific info for a block exists, do NOT create it.
                    JSON structure: {
                        "labels": {"summary": "", "experience": "", "education": "", "contacts": "", "languages": "", "hobbies": "", "links": ""}, 
                        "name": "", "title": "", "contacts": {"p": "", "e": "", "l": ""}, 
                        "socials": {"li": "", "gh": "", "tg": ""}, "summary": "", "atsScore": 85, 
                        "experience": [{"c": "", "p": "", "t": "", "d": ""}], 
                        "education": [{"s": "", "d": "", "y": ""}], 
                        "languages": [], "hobbies": [], 
                        "additional": [{"title": "", "content": ""}]
                    }`;

                    const result = await model.generateContent(prompt + " Text: " + text.substring(0, 9000));
                    const response = await result.response;
                    const jsonStr = response.text().substring(response.text().indexOf('{'), response.text().lastIndexOf('}') + 1);
                    const parsedData = JSON.parse(jsonStr);
                    setResumeData(parsedData);
                    await autoPublish(parsedData);
                    setStep('result');
                } catch (err) { alert("Error"); }
                setLoading(false);
            };

            const handleFile = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                setLoading(true);
                setLoadingStage(0);
                try {
                    let text = "";
                    if (file.type === "application/pdf") {
                        const pdf = await pdfjs.getDocument({ data: await file.arrayBuffer() }).promise;
                        for (let i = 1; i <= Math.min(pdf.numPages, 5); i++) {
                            const page = await pdf.getPage(i);
                            const content = await page.getTextContent();
                            text += content.items.map(s => s.str).join(" ") + " ";
                        }
                    } else if (file.name.endsWith('.docx')) {
                        const arrayBuffer = await file.arrayBuffer();
                        const result = await window.mammoth.extractRawText({ arrayBuffer: arrayBuffer });
                        text = result.value; 
                    } else { text = await file.text(); }
                    await processAI(text);
                } catch (err) { setLoading(false); }
            };

            if (step === 'setup') return (
                <div className="max-w-4xl mx-auto px-4 py-20 text-center flex flex-col min-h-screen">
                    <div className="flex-grow">
                        <h1 className="text-6xl sm:text-8xl font-black mb-6 italic tracking-tighter inline-block bg-gradient-to-r from-emerald-400 to-blue-500 bg-clip-text text-transparent">ResumeLink</h1>
                        <p className="text-gray-400 mb-12 text-xl sm:text-2xl font-light italic">{curr.mainTitle}</p>
                        
                        <div className="inline-block mb-20">
                            {loading ? (
                                <div className="p-10 sm:p-20 bg-[#161616] border border-white/5 rounded-[40px] space-y-6">
                                    <div className="spinner mx-auto"></div>
                                    <p className="text-emerald-500 font-bold animate-pulse uppercase text-sm">{curr.stages[loadingStage]}</p>
                                </div>
                            ) : (
                                <div className="glow-wrapper">
                                    <div className="glow-content p-8 sm:p-20">
                                        <label className="bg-emerald-600 hover:bg-emerald-500 px-8 sm:px-16 py-6 rounded-2xl font-bold cursor-pointer inline-block text-lg shadow-xl transition-all">
                                            {curr.uploadBtn} <input type="file" onChange={handleFile} className="hidden" />
                                        </label>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                            {curr.steps.map((s, i) => (
                                <div key={i} className="bg-[#111] p-8 rounded-3xl border border-white/5">
                                    <div className="text-emerald-500 font-black mb-2 italic">0{i+1}</div>
                                    <h4 className="font-bold text-sm mb-2 uppercase tracking-widest">{s.t}</h4>
                                    <p className="text-gray-500 text-xs leading-relaxed">{s.d}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                    <footer className="mt-20 pt-10 border-t border-white/5 space-y-4">
                        <p className="text-gray-600 text-sm italic">{curr.footerEng}</p>
                        <div className="text-gray-500 text-[10px] uppercase tracking-widest font-bold">
                            {curr.contact} <a href="mailto:resumelinkcc@gmail.com" className="text-emerald-500">resumelinkcc@gmail.com</a>
                        </div>
                    </footer>
                </div>
            );

            const L = resumeData.labels;
            return (
                <div className="max-w-6xl mx-auto px-4 py-10 space-y-8">
                    <div className="flex justify-between items-center">
                        <h1 className="text-3xl font-black bg-gradient-to-r from-emerald-400 to-blue-500 bg-clip-text text-transparent italic">ResumeLink</h1>
                        <button onClick={() => {window.location.search=""; setStep('setup');}} className="text-gray-600 text-[10px] font-bold uppercase border border-white/5 px-5 py-2 rounded-full font-bold uppercase">{curr.backBtn}</button>
                    </div>
                    <div className="grid-layout">
                        <div className="card-item col-span-full flex flex-col md:flex-row justify-between items-center bg-[#111] p-10">
                            <div>
                                <h2 className="text-4xl md:text-[56px] name-fix tracking-tighter" contentEditable="true" suppressContentEditableWarning={true}>{resumeData.name}</h2>
                                <p className="text-emerald-400 font-bold uppercase tracking-widest text-[14px] mt-4">{resumeData.title}</p>
                            </div>
                            <div className="text-right">
                                <div className="text-emerald-500 text-2xl font-black">{resumeData.atsScore}%</div>
                                <p className="text-[12px] text-gray-500 uppercase font-bold">{curr.atsScore}</p>
                            </div>
                        </div>

                        {resumeData.summary && (
                            <div className="card-item col-span-1 md:col-span-3">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-6 tracking-widest">{L.summary}</h3>
                                <p className="text-[22px] font-medium text-gray-200">{resumeData.summary}</p>
                            </div>
                        )}

                        <div className="card-item bg-blue-500/5 border-blue-500/20">
                            <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-6 tracking-widest">{L.contacts}</h3>
                            <div className="space-y-4 text-[17px]">
                                {resumeData.contacts?.p && <p>üì± {resumeData.contacts.p}</p>}
                                {resumeData.contacts?.e && <p>‚úâÔ∏è {resumeData.contacts.e}</p>}
                                {resumeData.contacts?.l && <p>üìç {resumeData.contacts.l}</p>}
                            </div>
                        </div>

                        {resumeData.experience?.length > 0 && (
                            <div className="card-item col-span-1 md:col-span-3">
                                <h3 className="text-blue-400 text-[10px] font-bold uppercase mb-8 tracking-widest">{L.experience}</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                                    {resumeData.experience.map((ex, i) => (
                                        <div key={i} className="border-l-2 border-emerald-500/20 pl-5">
                                            <h4 className="font-bold text-[18px]">{ex.p}</h4>
                                            <p className="text-emerald-500 text-[14px] font-bold uppercase my-2">{ex.c} | {ex.t}</p>
                                            <p className="text-gray-400 text-[14px] leading-relaxed">{ex.d}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {resumeData.education?.length > 0 && (
                            <div className="card-item">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-8 tracking-widest">{L.education}</h3>
                                <div className="space-y-6">
                                    {resumeData.education.map((ed, i) => (
                                        <div key={i} className="border-b border-white/5 pb-4 last:border-0">
                                            <p className="font-bold text-[17px]">{ed.d}</p>
                                            <p className="text-gray-400 text-[14px] mt-1">{ed.s} ({ed.y})</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {resumeData.additional?.map((block, i) => block.title && (
                            <div key={i} className="card-item col-span-1 md:col-span-2">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-6 tracking-widest">{block.title}</h3>
                                <p className="text-[16px] text-gray-300 leading-relaxed">{block.content}</p>
                            </div>
                        ))}

                        {(resumeData.languages?.length > 0 || resumeData.hobbies?.length > 0) && (
                            <div className="card-item">
                                {resumeData.languages?.length > 0 && (
                                    <div className="mb-8">
                                        <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-4 tracking-widest">{L.languages}</h3>
                                        <p className="text-gray-300 text-sm">{resumeData.languages.join(", ")}</p>
                                    </div>
                                )}
                                {resumeData.hobbies?.length > 0 && (
                                    <div>
                                        <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-4 tracking-widest">{L.hobbies}</h3>
                                        <p className="text-gray-300 text-sm">{resumeData.hobbies.join(", ")}</p>
                                    </div>
                                )}
                            </div>
                        )}

                        <div className="card-item col-span-1 md:col-span-2 flex items-center justify-between bg-gradient-to-br from-[#111] to-[#1a1a1a]">
                            <div className="space-y-4 w-full">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase tracking-widest">{L.links}</h3>
                                <div className="flex gap-3 text-2xl">
                                    <a href={resumeData.socials?.li || "#"} target="_blank">üîó</a>
                                    <a href={resumeData.socials?.gh || "#"} target="_blank">üêô</a>
                                    <a href={resumeData.socials?.tg || "#"} target="_blank">‚úàÔ∏è</a>
                                </div>
                            </div>
                            <div className="bg-white p-2 rounded-2xl shrink-0">
                                <img src={`https://api.qrserver.com/v1/create-qr-code/?size=90x90&data=${encodeURIComponent(window.location.href)}`} alt="QR" />
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
