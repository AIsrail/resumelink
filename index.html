<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeLink ‚Äî –¢–≤–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å</title>

    <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="manifest" href="/favicon/site.webmanifest">

    <meta property="og:title" content="ResumeLink ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ–∑—é–º–µ –ø–æ —Å—Å—ã–ª–∫–µ">
    <meta property="og:description" content="–ó–∞–≥—Ä—É–∑–∏ PDF —Ä–µ–∑—é–º–µ –∏ –ø–æ–ª—É—á–∏ –∫—Ä–∞—Å–∏–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å–æ —Å—Å—ã–ª–∫–æ–π –∏ QR-–∫–æ–¥–æ–º">
    <meta property="og:image" content="https://resumelink.cc/og-image.png">
    <meta property="og:url" content="https://resumelink.cc">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="importmap">
        { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
    </script>

    <style>
        body { background: #0a0a0a; font-family: 'Outfit', sans-serif; color: white; min-height: 100vh; margin: 0; overflow-x: hidden; }
        .grid-layout { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; grid-auto-rows: min-content; }
        
        .card-item { 
            background: #161616; border: 1px solid #262626; border-radius: 32px; padding: 1.8rem; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative; height: auto; min-height: fit-content; word-break: break-word; box-sizing: border-box;
        }

        .card-item:hover { 
            transform: scale(1.02); border-color: #10b981; box-shadow: 0 20px 40px rgba(0,0,0,0.4); 
            z-index: 50 !important; padding: 2.2rem;
        }

        .zoom-text { display: inline-block; transition: all 0.3s ease; transform-origin: left center; width: 100%; }
        .card-item:hover .zoom-text:not(.no-zoom),
        .card-item:hover .zoom-text:not(.no-zoom) p,
        .card-item:hover .zoom-text:not(.no-zoom) span { 
            transform: scale(1.08); 
            color: #ffffff !important; 
        }

        @media (max-width: 640px) {
            .card-item.in-view { transform: scale(1.02); border-color: #10b981; }
            .card-item.in-view .zoom-text:not(.no-zoom) { transform: scale(1.05); }
        }

        .no-zoom { transform: none !important; }
        .name-fix { 
            font-weight: 900; 
            line-height: 1.2 !important; 
            display: block; 
            padding: 0.15em 0; 
            letter-spacing: -0.02em; 
        }
        
        .spinner { border: 3px solid #222; border-top: 3px solid #10b981; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        @media (max-width: 1024px) { .grid-layout { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 640px) { .grid-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";
        const { useState, useEffect } = React;
        const pdfjs = window['pdfjs-dist/build/pdf'];
        pdfjs.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const WORKER_URL = "https://resumelink-worker.aisrail.workers.dev";

        function App() {
            const [resumeData, setResumeData] = useState(null);
            const [loading, setLoading] = useState(false);
            const [loadingStage, setLoadingStage] = useState(0); 
            const [step, setStep] = useState('setup');
            const [savedId, setSavedId] = useState(null);
            const [showTooltip, setShowTooltip] = useState(false);
            
            const apiKey = 'AIzaSyAQ_Sr41LA4HGKkIakTin0okQnyblOl0Ts';

            const isEn = navigator.language.startsWith('en');

            const T = {
                en: {
                    mainTitle: "Turn text into a stylish profile",
                    uploadBtn: "Upload Resume",
                    publishBtn: "Publish",
                    published: "Link copied to clipboard!",
                    backBtn: "‚Üê Back",
                    atsScore: "ATS Score",
                    atsHint: "This score reflects how successfully your resume will pass automatic HR filters. 80%+ is an excellent result!",
                    how: "HOW IT WORKS",
                    contact: "For cooperation:",
                    footerEng: "Empowering professionals with AI-driven visual storytelling.",
                    steps: [
                        { t: "UPLOAD", d: "Upload your file in any format." },
                        { t: "AI MAGIC", d: "AI structures data and calculates ATS." },
                        { t: "SHARE", d: "Get your link and personal QR code." }
                    ],
                    stages: ["Analyzing text...", "Extracting data...", "Generating blocks...", "Creating QR code...", "Optimizing mobile layout...", "Finalizing interactive elements...", "Almost ready..."]
                },
                ru: {
                    mainTitle: "–ü—Ä–µ–≤—Ä–∞—Ç–∏ —Ç–µ–∫—Å—Ç –≤ —Å—Ç–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å",
                    uploadBtn: "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—é–º–µ",
                    publishBtn: "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å",
                    published: "–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!",
                    backBtn: "‚Üê –ù–∞–∑–∞–¥",
                    atsScore: "ATS Score",
                    atsHint: "–≠—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç—Ä–∞–∂–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω–æ –≤–∞—à–µ —Ä–µ–∑—é–º–µ –ø—Ä–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã HR-—Å–∏—Å—Ç–µ–º. 80%+ ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!",
                    how: "–ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢",
                    contact: "–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞:",
                    footerEng: "Empowering professionals with AI-driven visual storytelling.",
                    steps: [
                        { t: "–ó–ê–ì–†–£–ó–ö–ê", d: "–ó–∞–≥—Ä—É–∑–∏ —Ñ–∞–π–ª –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ." },
                        { t: "AI –ú–ê–ì–ò–Ø", d: "–ù–µ–π—Ä–æ—Å–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ —Å—á–∏—Ç–∞–µ—Ç ATS." },
                        { t: "–ü–û–î–ï–õ–ò–¢–¨–°–Ø", d: "–ü–æ–ª—É—á–∏ —Å—Å—ã–ª–∫—É –∏ –ª–∏—á–Ω—ã–π QR-–∫–æ–¥." }
                    ],
                    stages: ["–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç...", "–ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ...", "–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–ª–æ–∫–∏...", "–°–æ–∑–¥–∞—ë–º QR-–∫–æ–¥...", "–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å—Ç–∫—É...", "–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤...", "–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ..."]
                }
            };

            const curr = isEn ? T.en : T.ru;
            const stages = curr.stages;

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const id = params.get('id');
                if (id) {
                    setLoading(true);
                    fetch(`${WORKER_URL}/${id}`)
                        .then(res => res.json())
                        .then(data => {
                            setResumeData(data);
                            setSavedId(id);
                            setStep('result');
                            setLoading(false);
                        })
                        .catch(() => {
                            setLoading(false);
                        });
                }
            }, []);

            useEffect(() => {
                let interval;
                if (loading) {
                    interval = setInterval(() => {
                        setLoadingStage(prev => (prev < stages.length - 1 ? prev + 1 : prev));
                    }, 2500);
                }
                return () => clearInterval(interval);
            }, [loading, stages.length]);

            const handlePublish = async () => {
                setLoading(true);
                try {
                    const res = await fetch(WORKER_URL, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(resumeData)
                    });
                    const result = await res.json();
                    setSavedId(result.id);
                    const newUrl = `${window.location.origin}${window.location.pathname}?id=${result.id}`;
                    navigator.clipboard.writeText(newUrl);
                    alert(curr.published);
                } catch (err) {
                    alert("Error publishing");
                }
                setLoading(false);
            };

            const processAI = async (text) => {
                try {
                    const genAI = new GoogleGenerativeAI(apiKey);
                    const model = genAI.getGenerativeModel({ model: "gemini-flash-latest" });
                    const prompt = `Analyze the provided text. 1. Target language: ${isEn ? 'English' : 'Source text language'}. 2. Extract info into JSON. 3. MANDATORY: Translate ALL keys in "labels" AND ALL "title" fields in "additional" array to the target language. Structure: {"labels": {"summary": "", "experience": "", "education": "", "contacts": "", "languages": "", "hobbies": "", "links": ""}, "name": "Full Name", "title": "Job Title", "contacts": {"p": "", "e": "", "l": ""}, "socials": {"li": "", "gh": "", "tg": ""}, "summary": "", "atsScore": 85, "experience": [{"c": "", "p": "", "t": "", "d": ""}], "education": [{"s": "", "d": "", "y": ""}], "languages": [], "hobbies": [], "additional": [{"title": "", "content": ""}]}`;
                    const result = await model.generateContent(prompt + " Source Text: " + text.substring(0, 9000));
                    const response = await result.response;
                    const jsonStr = response.text().substring(response.text().indexOf('{'), response.text().lastIndexOf('}') + 1);
                    setResumeData(JSON.parse(jsonStr));
                    setStep('result');
                } catch (err) { alert("–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞."); }
                setLoading(false);
            };

            const handleFile = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                setLoading(true);
                setLoadingStage(0);
                try {
                    let text = "";
                    if (file.type === "application/pdf") {
                        const pdf = await pdfjs.getDocument({ data: await file.arrayBuffer() }).promise;
                        for (let i = 1; i <= Math.min(pdf.numPages, 5); i++) {
                            const page = await pdf.getPage(i);
                            const content = await page.getTextContent();
                            text += content.items.map(s => s.str).join(" ") + " ";
                        }
                    } else if (file.name.endsWith('.docx')) {
                        const arrayBuffer = await file.arrayBuffer();
                        const result = await window.mammoth.extractRawText({ arrayBuffer: arrayBuffer });
                        text = result.value; 
                    } else { text = await file.text(); }
                    await processAI(text);
                } catch (err) { alert("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞."); setLoading(false); }
            };

            if (step === 'setup') return (
                <div className="max-w-4xl mx-auto px-4 py-20 text-center flex flex-col min-h-screen">
                    <div className="flex-grow">
                        <h1 className="text-6xl sm:text-8xl font-black mb-6 italic tracking-tighter inline-block bg-gradient-to-r from-emerald-400 to-blue-500 bg-clip-text text-transparent">ResumeLink</h1>
                        <p className="text-gray-400 mb-12 text-xl sm:text-2xl font-light italic">{curr.mainTitle}</p>
                        <div className="inline-block p-1 bg-[#161616] border border-white/5 rounded-[40px] max-w-full overflow-hidden mb-20">
                            <div className="p-8 sm:p-20 border-dashed border-2 border-emerald-500/10 rounded-[36px]">
                                {loading ? ( 
                                    <div className="space-y-6">
                                        <div className="spinner mx-auto"></div>
                                        <p className="text-emerald-500 font-bold animate-pulse tracking-widest uppercase text-sm">{stages[loadingStage]}</p>
                                    </div>
                                ) : (
                                    <label className="bg-emerald-600 hover:bg-emerald-500 px-8 sm:px-16 py-6 rounded-3xl font-bold cursor-pointer transition-all inline-block text-lg shadow-2xl whitespace-nowrap">
                                        {curr.uploadBtn} <input type="file" onChange={handleFile} className="hidden" />
                                    </label>
                                )}
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                            {curr.steps.map((s, i) => (
                                <div key={i} className="bg-[#111] p-8 rounded-3xl border border-white/5">
                                    <div className="text-emerald-500 font-black mb-2 italic">0{i+1}</div>
                                    <h4 className="font-bold text-sm mb-2 uppercase tracking-widest">{s.t}</h4>
                                    <p className="text-gray-500 text-xs leading-relaxed">{s.d}</p>
                                </div>
                            ))}
                        </div>
                    </div>

                    <footer className="mt-20 pt-10 border-t border-white/5 space-y-4">
                        <p className="text-gray-600 text-sm italic">{curr.footerEng}</p>
                        <div className="text-gray-500 text-[10px] uppercase tracking-widest font-bold">
                            {curr.contact} <a href="mailto:resumelinkcc@gmail.com" className="text-emerald-500 hover:underline">resumelinkcc@gmail.com</a>
                        </div>
                    </footer>
                </div>
            );

            const L = resumeData.labels;
            const shareUrl = savedId ? `${window.location.origin}${window.location.pathname}?id=${savedId}` : window.location.href;

            return (
                <div className="max-w-6xl mx-auto px-4 py-10 space-y-8" onClick={() => setShowTooltip(false)}>
                    <div className="flex justify-between items-center">
                        <h1 className="text-3xl font-black bg-gradient-to-r from-emerald-400 to-blue-500 bg-clip-text text-transparent italic">ResumeLink</h1>
                        <div className="flex gap-4 items-center">
                            {!savedId && (
                                <button onClick={handlePublish} className="bg-emerald-600 hover:bg-emerald-500 px-6 py-2 rounded-full font-bold text-[10px] uppercase transition-all shadow-lg">
                                    {loading ? "..." : curr.publishBtn}
                                </button>
                            )}
                            <button onClick={() => {window.location.search=""; setStep('setup');}} className="text-gray-600 text-[10px] font-bold uppercase border border-white/5 px-5 py-2 rounded-full">{curr.backBtn}</button>
                        </div>
                    </div>

                    <div className="grid-layout">
                        <div className="card-item col-span-full flex flex-col md:flex-row justify-between items-start md:items-center bg-[#111] border-emerald-500/10 p-10 gap-6" style={{overflow: 'visible'}}>
                            <div className="max-w-2xl">
                                <h2 className="text-4xl md:text-[56px] name-fix tracking-tighter no-zoom" contentEditable="true" suppressContentEditableWarning={true}>{resumeData.name}</h2>
                                <p className="text-emerald-400 font-bold uppercase tracking-widest text-[14px] mt-4 no-zoom">{resumeData.title}</p>
                            </div>
                            <div className="text-left md:text-right relative">
                                <div className="text-emerald-500 text-2xl font-black no-zoom leading-none">{resumeData.atsScore}%</div>
                                <p className="text-[12px] text-gray-500 uppercase tracking-widest mt-2 font-bold no-zoom flex items-center md:justify-end">{curr.atsScore} 
                                    <span className="cursor-pointer text-emerald-500 text-[18px] ml-2" onClick={(e) => { e.stopPropagation(); setShowTooltip(!showTooltip); }}>(?)</span>
                                </p>
                                {showTooltip && (
                                    <div className="fixed sm:absolute z-[100] top-[20%] sm:top-full left-1/2 sm:left-auto transform -translate-x-1/2 sm:translate-x-0 sm:right-0 mt-3 w-[90vw] sm:w-64 p-5 bg-zinc-900 border border-emerald-500/40 rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] text-[14px] text-gray-200 text-left">
                                        {curr.atsHint}
                                    </div>
                                )}
                            </div>
                        </div>

                        {resumeData.summary && (
                            <div className="card-item col-span-1 md:col-span-3">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-6 no-zoom tracking-widest">{L.summary}</h3>
                                <p className="text-[22px] font-medium no-zoom text-gray-200">{resumeData.summary}</p>
                            </div>
                        )}

                        {(resumeData.contacts?.p || resumeData.contacts?.e || resumeData.contacts?.l) && (
                            <div className="card-item bg-blue-500/5 border-blue-500/20">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-6 no-zoom tracking-widest">{L.contacts}</h3>
                                <div className="space-y-4 text-[17px] zoom-text">
                                    {resumeData.contacts?.p && <p>üì± {resumeData.contacts.p}</p>}
                                    {resumeData.contacts?.e && <p>‚úâÔ∏è {resumeData.contacts.e}</p>}
                                    {resumeData.contacts?.l && <p>üìç {resumeData.contacts.l}</p>}
                                </div>
                            </div>
                        )}

                        {resumeData.experience?.length > 0 && (
                            <div className="card-item col-span-1 md:col-span-3">
                                <h3 className="text-blue-400 text-[10px] font-bold uppercase mb-8 no-zoom tracking-widest">{L.experience}</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                                    {resumeData.experience.map((ex, i) => (
                                        <div key={i} className="border-l-2 border-emerald-500/20 pl-5">
                                            <h4 className="font-bold text-[18px] no-zoom">{ex.p}</h4>
                                            <p className="text-emerald-500 text-[14px] font-bold uppercase my-2 no-zoom">{ex.c} | {ex.t}</p>
                                            <p className="text-gray-400 text-[14px] zoom-text leading-relaxed">{ex.d}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {resumeData.education?.length > 0 && (
                            <div className="card-item">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-8 no-zoom tracking-widest">{L.education}</h3>
                                <div className="space-y-6">
                                    {resumeData.education.map((ed, i) => (
                                        <div key={i} className="border-b border-white/5 pb-4 last:border-0 zoom-text">
                                            <p className="font-bold text-[17px]">{ed.d}</p>
                                            <p className="text-gray-400 text-[14px] mt-1">{ed.s} ({ed.y})</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {resumeData.additional?.map((block, i) => block.title && (
                            <div key={i} className="card-item col-span-1 md:col-span-2">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase mb-6 no-zoom tracking-widest">{block.title}</h3>
                                <p className="text-[16px] text-gray-300 zoom-text leading-relaxed">{block.content}</p>
                            </div>
                        ))}

                        <div className="card-item col-span-1 md:col-span-2 flex items-center justify-between bg-gradient-to-br from-[#111] to-[#1a1a1a]">
                            <div className="space-y-4 w-full">
                                <h3 className="text-blue-400 text-[12px] font-bold uppercase no-zoom tracking-widest">{L.links}</h3>
                                <div className="flex gap-3">
                                    <a href={resumeData.socials?.li || "#"} target="_blank" className="p-3 bg-blue-600/20 rounded-2xl text-2xl">üîó</a>
                                    <a href={resumeData.socials?.gh || "#"} target="_blank" className="p-3 bg-white/5 rounded-2xl text-2xl">üêô</a>
                                    <a href={resumeData.socials?.tg || "#"} target="_blank" className="p-3 bg-sky-500/20 rounded-2xl text-2xl">‚úàÔ∏è</a>
                                </div>
                            </div>
                            <div className="bg-white p-2 rounded-2xl shrink-0">
                                <img src={`https://api.qrserver.com/v1/create-qr-code/?size=90x90&data=${encodeURIComponent(shareUrl)}`} alt="QR" />
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
